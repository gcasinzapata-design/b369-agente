'use client'; import dynamic from 'next/dynamic'; import {useState,useEffect} from 'react'; const MapContainer = dynamic(()=>import('react-leaflet').then(m=>m.MapContainer),{ssr:false}); const TileLayer = dynamic(()=>import('react-leaflet').then(m=>m.TileLayer),{ssr:false}); const Circle = dynamic(()=>import('react-leaflet').then(m=>m.Circle),{ssr:false}); const useMapEvents = dynamic(()=>import('react-leaflet').then(m=>m.useMapEvents),{ssr:false}); export default function MapZones({onZonesChange}:{onZonesChange:(z:any[])=>void}){ const [zones,setZones]=useState([]); const [r,setR]=useState(1); useEffect(()=>onZonesChange(zones),[zones]); function add(lat,lng){ setZones(z=>[...z,{lat,lng,radiusKm:r}]); } return (<div><div style={{marginBottom:6}}>Click en mapa para agregar radio</div><div style={{height:260}}><MapContainer center={[-12.121,-77.03]} zoom={12} style={{height:'100%',width:'100%'}}><TileLayer url='https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'/>{/* @ts-ignore */}<MapClickHandler onAdd={add}/>{zones.map((z,i)=>(<Circle key={i} center={[z.lat,z.lng]} radius={z.radiusKm*1000}/>))}</MapContainer></div></div>); }
function MapClickHandler({onAdd}:{onAdd:(a:number,b:number)=>void}){ const mapEvents = require('react-leaflet').useMapEvents; // dynamic require to avoid ts build issues
 // @ts-ignore
 mapEvents({ click(e:any){ onAdd(e.latlng.lat,e.latlng.lng); } });
 return null;
}
